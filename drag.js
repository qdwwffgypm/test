!function(a,b){if("undefined"!=typeof module)require("./offset"),module.exports=b(a);else if(b(a),"function"==typeof define&&(define.amd||define.cmd)){var c="//"+(!/ppppoints.com/.test(document.domain)?"j.changyoyo.com":"j.ppppoints.com")+"/static/js/";requirejs.config({paths:{offset:c+"libs/offset"}}),define("drag",["offset"],function(){return b(a)})}}(window||this,function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;return!a.CY&&(a.CY={}),a.CY.drag?a.CY.drag:(b=document,c=b.body,d=CY.offset,e=function(a,c){return a=b.createElement(a),i(a.style,c||{}),a},f=function(a,b){return a&&a instanceof Object?a:a?(b||document).querySelector(a):null},g=function(a){return Object.prototype.toString.call(a).split(/\s(\w+)/)[1].toLowerCase()},h=function(a,b,c){n("array"!=g(a)?[a]:a,function(a,d){b.split(" ").forEach(function(a){d.addEventListener(a,c,!1)})})},i=function(a,b){for(var c in b)b.hasOwnProperty(c)&&("object"!=g(b[c])?void 0!=b[c]&&(a[c]=b[c]):a[c]=i(a[c]||{},b[c]));return a},j=function(a){i(a.style,{display:"block"})},k=function(a){i(a.style,{display:"none"})},l=function(a){return a.offsetWidth},m=function(a){return a.offsetHeight},n=function(a,b){a=a||[];for(var c=0,d=a.length;d>c&&0!=b.call(a[c],c,a[c]);c++);},o=function(a,b){var d=[];return b=f(b),b&&n(b.querySelectorAll("div")||[],function(b,c){(c.className||"").split(/\s+/).forEach(function(b){b==a&&d.push(c)})}),d},p=function(a,b,d){for(var e=null,f=!1,g=d.target||d.srcElement;g&&g!=c&&!f;)1==g.nodeType&&(g.className||"").split(/\s+/).forEach(function(b){b==a&&(e=g)}),f||g!=b||(f=!0),g=g["parentNode"];return f?e:null},b.onselectstart=new Function("event.returnValue=false;"),q=function(a){var r,s,t,u,v,w,x,y,z,A,C,D,E,F,G,H,I,J,K,L,g=this;return g instanceof q?(r=[],s=[],t=[],u=[],a=i({menuLayout:"",menuItem:"",pageLayout:"",dashedCss:""},a),v=f(a.menuLayout),w=f(a.pageLayout),z=l(v),A="px",C=!1,D=null,E=0,F=0,G=0,H=e("div",{border:"1px dashed #666"}),I=null,J=!1,K=null,L=null,h(b,"mousedown",function(b){var c,e,f,g,h;I=null,g=b.pageX,h=b.pageY,K=g,L=h,e=p(a.menuItem,v,b),f=p(a.menuItem,w,b),(e||f)&&(e&&(I=!0,D=e.cloneNode(!0),D.data=i({},D.data||{})),f&&(I=!1,D=f),C=!0,c=e||f,D.data=c.data,b.preventDefault(),x=o(a.menuItem,v),y=o(a.menuItem,w),E=h-d(c).top,F=g-d(c).left,G=l(c),currItem_height=m(c),J=!1)}),h(b,"mousemove",function(a){var f,h,b=a.pageX,e=a.pageY;if(C&&D){for(f=0;f<s.length;f++)if(0==s[f].call(g,D,I,H,x,y))return;i(D.style,{position:"absolute",top:e-E+A,left:b-F+A}),(I?G+(b-F)>z:b>F)?(w.appendChild(H),y[0]&&(h=y[y.length-1],e>d(h).top+m(h)?w.appendChild(H):n(y,function(a,b){b!=D&&e>d(b).top&&e<d(b).top+m(b)&&w.insertBefore(H,b)})),i(H.style,{border:"1px dashed #666",height:currItem_height+A}),j(H),I||K!=b||L!=e||i(H.style,{border:"none"})):k(H),J||(i(D.style,{zIndex:10,width:G+A,height:currItem_height+A}),c.appendChild(D)),J=!0}}),h(b,"mouseup",function(b){if(J&&C&&("block"==H.style.display?(w.insertBefore(D,H),i(D.style,{position:"static",width:"",height:""}),c.appendChild(H),k(H),n(t,function(){this.call(g,D,I,H,x,y)})):D&&D.parentNode.removeChild(D)),!J&&C){var d=p(a.menuItem,w,b);d&&n(u,function(){this.call(g,D,!1,H,x,y)})}D=null,C=!1,J=!1}),{addStartHooks:function(a){r.push(a)},addMoveHooks:function(a){s.push(a)},addStopHooks:function(a){t.push(a)},addClickPageItem:function(a){u.push(a)}}):new q(a)},a.CY.drag=q,q)});